---
title: "Case-Study-2"
author: "Kushal Regmi"
date: "7/8/2022"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

```{r}
customers = read.csv("casestudy.csv")
```

```{r}
customers_wider <- customers %>%
  pivot_wider(names_from = year, values_from = net_revenue ) 
```



## Total Revenue for each current year

```{r}
customers %>%
  group_by(year) %>%
  summarise(Total_Revenue = sum(net_revenue))
```

## New Customer Revenue for years 2016 and 2017 (new customers not present in previous year)

```{r}
customers_2015 <- customers  %>%
  filter(year == 2015)

customers_2016 <- customers  %>%
  filter(year == 2016)

customers_2017 <- customers  %>%
  filter(year == 2017)


new_customer_2016 <- anti_join(customers_2016, customers_2015, by = c("customer_email" = "customer_email"))
new_customer_2017 <- anti_join(customers_2017, customers_2016, by = c("customer_email" = "customer_email"))


new_customer_2016 %>%
  summarise(Total_Revenue = sum(net_revenue))

new_customer_2017 %>%
  summarise(Total_Revenue = sum(net_revenue))
```


## Total Customers 2015

```{r}
length(unique(customers_2015[["customer_email"]]))

```

## Total Customers 2016

```{r}
length(unique(customers_2016[["customer_email"]]))
```

## Total Customers 2017

```{r}
length(unique(customers_2017[["customer_email"]]))
```


## New Customers in 2016

```{r}
length(unique(new_customer_2016[["customer_email"]]))
```

## New Customers in 2017

```{r}
length(unique(new_customer_2017[["customer_email"]]))
```



## Lost customers not present following years of 2016 and 2017

```{r}
customers_lost_2016 <- anti_join(customers_2015, customers_2016, by = c("customer_email" = "customer_email"))
customers_lost_2017 <- anti_join(customers_2016, customers_2017, by = c("customer_email" = "customer_email"))

length(unique(customers_lost_2016[["customer_email"]]))
length(unique(customers_lost_2017[["customer_email"]]))
```


## Calculate number of exisiting customers from previous year 

```{r}
customers_existing_2016 <- inner_join(customers_2015, customers_2016, by = c("customer_email" = "customer_email"))

customers_existing_2017 <- inner_join(customers_2016, customers_2017, by = c("customer_email" = "customer_email"))
```


## Existing Customer Growth for 2016 

```{r}
customers_existing_2016 %>%
  select(-X.x, -X.y) %>%
  mutate( existing_customer_growth_2016 = (net_revenue.y - net_revenue.x))
```
## Existing Customer Growth for 2017

```{r}
customers_existing_2017 %>%
  select(-X.x, -X.y) %>%
  mutate( existing_customer_growth_2017 = (net_revenue.y - net_revenue.x))
```



