---
title: "Case-Study-2"
author: "Kushal Regmi"
date: "7/8/2022"
output: html_document
---

### package and data setup

```{r setup, include=FALSE}
library(tidyverse)
```

```{r}
customers = read.csv("casestudy.csv")
```




## Total Revenue for each current year 2017 is $31,417,495

```{r}
customers %>%
  group_by(year) %>%
  summarise(Total_Revenue = sum(net_revenue))
```





## New Customer Revenue for years 2016 and 2017 (new customers not present in previous year)

```{r}
customers_2015 <- customers  %>%
  filter(year == 2015)

customers_2016 <- customers  %>%
  filter(year == 2016)

customers_2017 <- customers  %>%
  filter(year == 2017)


new_customer_2016 <- anti_join(customers_2016, customers_2015, by = c("customer_email" = "customer_email"))
new_customer_2017 <- anti_join(customers_2017, customers_2016, by = c("customer_email" = "customer_email"))


new_customer_2016 %>%
  summarise(Total_new_customer_Revenue_2016 = sum(net_revenue))

new_customer_2017 %>%
  summarise(Total_new_customer_Revenue_2017 = sum(net_revenue))
```

### new customer revenue for 2016 was $18,245,491

### new customer revenue for 2017 was $28,776,235




```{r}
# join tables for customers present year prior and year of
customers_existing_2016 <- inner_join(customers_2015, customers_2016, by = c("customer_email" = "customer_email"))

customers_existing_2017 <- inner_join(customers_2016, customers_2017, by = c("customer_email" = "customer_email"))
```


## Existing Individual Customer Growth for 2016 

```{r}
customers_existing_2016 %>%
  select(-X.x, -X.y) %>%
  mutate( existing_customer_growth_2016 = (net_revenue.y - net_revenue.x)) %>%
  head(10)

```


## Existing Individual Customer Growth for 2017

```{r}
customers_existing_2017 %>%
  select(-X.x, -X.y) %>%
  mutate( existing_customer_growth_2017 = (net_revenue.y - net_revenue.x)) %>%
  head(10)
```





```{r}
# total revenue for each year

customers_2015_revenue <-
  customers_2015 %>%
  summarise(Total_Revenue = sum(net_revenue))

customers_2016_revenue <-
  customers_2016 %>%
  summarise(Total_Revenue = sum(net_revenue))

customers_2017_revenue <-
  customers_2017 %>%
  summarise(Total_Revenue = sum(net_revenue))


```



## Revenue lost from attrition in 2016 was -$3,305,806 

```{r}
attrition_2016 = customers_2016_revenue[1] - customers_2015_revenue[1]

attrition_2016
```

## Revenue was not lost from attrition in 2017 as revenue grew $5,686,551

```{r}
attrition_2017 = customers_2017_revenue[1] - customers_2016_revenue[1]

attrition_2017
```




## Exisiting 2016 Customer Revenue In 2016: $7,485,453

```{r}
customers_existing_2016 %>%
  summarise(Total_Revenue = sum(net_revenue.y))
  
```


## Exisiting 2016 Customer Revenue In 2015: $7,465,117	

```{r}
customers_existing_2016 %>%
  summarise(Total_Revenue = sum(net_revenue.x))
```


## Existing 2017 Customer Revenue In 2017: $2,641,260	

```{r}
customers_existing_2017 %>%
  summarise(Total_Revenue = sum(net_revenue.y))
```

## Exisitng 2017 Customer Revenue In 2016: $2,620,649	


```{r}
customers_existing_2017 %>%
  summarise(Total_Revenue = sum(net_revenue.x))
```


## Total Customers 2015: 231,294

```{r}
length(unique(customers_2015[["customer_email"]]))

```

## Total Customers 2016: 204,646

```{r}
length(unique(customers_2016[["customer_email"]]))
```

## Total Customers 2017: 249,987

```{r}
length(unique(customers_2017[["customer_email"]]))
```


## New Customers in 2016: 145,062

```{r}
length(unique(new_customer_2016[["customer_email"]]))
```

## New Customers in 2017: 229,028

```{r}
length(unique(new_customer_2017[["customer_email"]]))
```



## Lost customers not present following years of 2016 and 2017

```{r}
customers_lost_2016 <- anti_join(customers_2015, customers_2016, by = c("customer_email" = "customer_email"))
customers_lost_2017 <- anti_join(customers_2016, customers_2017, by = c("customer_email" = "customer_email"))

length(unique(customers_lost_2016[["customer_email"]]))
length(unique(customers_lost_2017[["customer_email"]]))
```

# exisiting customers lost in 2016: 171,710
# exisiting customers lost in 2017: 183,687
